(function(){"use strict";var e={8356:function(e,t,r){var a=r(3751),i=r(641);const n={id:"app"};function s(e,t,r,a,s,l){const o=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",n,[(0,i.bF)(o)])}var l={name:"App"},o=r(6262);const u=(0,o.A)(l,[["render",s]]);var d=u,c=(r(8111),r(3579),r(5220)),m=r(953),h=r(4335);const p=h.A.create({baseURL:"http://45.95.212.18:44058/api",timeout:1e4,headers:{"Content-Type":"application/json"}});p.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e}),(e=>Promise.reject(e))),p.interceptors.response.use((e=>e),(e=>{if(e.response)switch(e.response.status){case 401:localStorage.removeItem("token"),localStorage.removeItem("user"),location.reload();break;case 403:console.error("没有权限访问该资源");break;case 404:console.error("请求的资源不存在");break;case 500:console.error("服务器错误");break;default:console.error("未知错误")}return Promise.reject(e)}));const g={auth:{register:e=>p.post("/auth/register",e),login:e=>p.post("/auth/login",e)},user:{getCurrentUser:()=>p.get("/users/me"),updateUser:e=>p.put("/users/me",e),getAllUsers:()=>p.get("/admin/users")},requirements:{getAll:()=>p.get("/requirements"),getById:e=>p.get(`/requirements/${e}`),create:e=>p.post("/requirements",e),update:(e,t)=>p.put(`/requirements/${e}`,t),delete:e=>p.delete(`/requirements/${e}`),getMyRequirementsWithApplications:()=>p.get("/requirements/my-requirements"),getMyApplications:()=>p.get("/requirements/my-applications"),acceptRequirement:e=>p.post(`/requirements/${e}/accept`),approveApplication:e=>p.post(`/requirements/${e}/approve`),rejectApplication:e=>p.post(`/requirements/${e}/reject`)},results:{getAll:()=>p.get("/results"),getById:e=>p.get(`/results/${e}`),getByUser:e=>p.get(`/results/user/${e}`),getByRequirement:e=>p.get(`/results/requirement/${e}`),create:e=>p.post("/results",e),update:(e,t)=>p.put(`/results/${e}`,t),delete:e=>p.delete(`/results/${e}`)}};var v=g;const q=()=>{const e=localStorage.getItem("user");return e?JSON.parse(e):null},b=()=>localStorage.getItem("token"),f=(0,m.Kh)({user:q(),token:b(),isAuthenticated:!!b(),error:null,loading:!1}),y={async register(e){f.loading=!0,f.error=null;try{const t=await v.auth.register(e);return t.data}catch(t){throw f.error=t.response?.data?.error||"注册失败，请重试",t}finally{f.loading=!1}},async login(e){f.loading=!0,f.error=null;try{const t=await v.auth.login(e),{user:r,token:a}=t.data;return localStorage.setItem("user",JSON.stringify(r)),localStorage.setItem("token",a),f.user=r,f.token=a,f.isAuthenticated=!0,r}catch(t){throw f.error=t.response?.data?.error||"登录失败，请检查您的凭据",t}finally{f.loading=!1}},logout(){localStorage.removeItem("user"),localStorage.removeItem("token"),f.user=null,f.token=null,f.isAuthenticated=!1},async getCurrentUser(){if(!f.token)return null;f.loading=!0;try{const e=await v.user.getCurrentUser(),t=e.data;return localStorage.setItem("user",JSON.stringify(t)),f.user=t,t}catch(e){return e.response&&401===e.response.status&&y.logout(),null}finally{f.loading=!1}},async updateUser(e){if(!f.isAuthenticated)return null;f.loading=!0;try{const t=await v.user.updateUser(e),r=t.data;return localStorage.setItem("user",JSON.stringify(r)),f.user=r,r}catch(t){throw f.error=t.response?.data?.error||"更新用户信息失败",t}finally{f.loading=!1}}};var k={state:f,...y};const R={class:"page"};function w(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("nav-bar");return(0,i.uX)(),(0,i.CE)("div",R,[(0,i.bF)(l,{title:"首页","show-back":!1}),t[0]||(t[0]=(0,i.Lk)("div",{class:"page-content home-content"},[(0,i.Lk)("div",{class:"welcome-section"},[(0,i.Lk)("h2",{class:"small-seal-font"},"生命树")])],-1)),(0,i.bF)(o)])}var E=r(33);const F={class:"header-bar"},C={class:"header-title"};function L(e,t,r,a,n,s){const l=(0,i.g2)("van-nav-bar");return(0,i.uX)(),(0,i.CE)("div",F,[(0,i.bF)(l,{"left-text":r.showBack?"返回":"","left-arrow":r.showBack,onClickLeft:s.onClickLeft,"right-text":r.rightText,onClickRight:s.onClickRight},{title:(0,i.k6)((()=>[(0,i.Lk)("span",C,(0,E.v_)(r.title),1)])),_:1},8,["left-text","left-arrow","onClickLeft","right-text","onClickRight"])])}var T={name:"HeaderBar",props:{title:{type:String,default:""},showBack:{type:Boolean,default:!0},rightText:{type:String,default:""}},methods:{onClickLeft(){this.showBack&&this.$router.back()},onClickRight(){this.$emit("right-click")}}};const I=(0,o.A)(T,[["render",L],["__scopeId","data-v-348dafc9"]]);var A=I;const S={class:"nav-bar"},_={class:"custom-icon"},D={class:"icon-circle"};function P(e,t,r,a,n,s){const l=(0,i.g2)("van-tabbar-item"),o=(0,i.g2)("van-icon"),u=(0,i.g2)("van-tabbar");return(0,i.uX)(),(0,i.CE)("div",S,[(0,i.bF)(u,{modelValue:n.active,"onUpdate:modelValue":t[10]||(t[10]=e=>n.active=e),route:""},{default:(0,i.k6)((()=>[(0,i.bF)(l,{to:"/requirements"},{icon:(0,i.k6)((()=>[(0,i.Lk)("div",{class:"custom-icon",onTouchstart:t[0]||(t[0]=e=>s.handleTouchStart("requirements")),onTouchend:t[1]||(t[1]=(...e)=>s.handleTouchEnd&&s.handleTouchEnd(...e)),onMousedown:t[2]||(t[2]=e=>s.handleMouseDown("requirements")),onMouseup:t[3]||(t[3]=(...e)=>s.handleMouseUp&&s.handleMouseUp(...e)),onMouseleave:t[4]||(t[4]=(...e)=>s.handleMouseUp&&s.handleMouseUp(...e))},t[11]||(t[11]=[(0,i.Lk)("div",{class:"icon-circle"},[(0,i.Lk)("img",{src:"https://b.yzcdn.cn/vant/dark-theme.svg",alt:"月亮",class:"theme-icon"})],-1)]),32)])),_:1}),(0,i.bF)(l,{to:"/profile"},{icon:(0,i.k6)((()=>[(0,i.Lk)("div",_,[(0,i.Lk)("div",D,[(0,i.bF)(o,{name:"contact",size:"24"})])])])),_:1}),(0,i.bF)(l,{to:"/results"},{icon:(0,i.k6)((()=>[(0,i.Lk)("div",{class:"custom-icon",onTouchstart:t[5]||(t[5]=e=>s.handleTouchStart("results")),onTouchend:t[6]||(t[6]=(...e)=>s.handleTouchEnd&&s.handleTouchEnd(...e)),onMousedown:t[7]||(t[7]=e=>s.handleMouseDown("results")),onMouseup:t[8]||(t[8]=(...e)=>s.handleMouseUp&&s.handleMouseUp(...e)),onMouseleave:t[9]||(t[9]=(...e)=>s.handleMouseUp&&s.handleMouseUp(...e))},t[12]||(t[12]=[(0,i.Lk)("div",{class:"icon-circle"},[(0,i.Lk)("img",{src:"https://b.yzcdn.cn/vant/light-theme.svg",alt:"太阳",class:"theme-icon"})],-1)]),32)])),_:1})])),_:1},8,["modelValue"])])}r(4114);var x=r(3326),$={name:"NavBar",data(){return{active:0,longPressTimer:null,longPressDelay:800,currentIcon:null}},watch:{$route(e){"/requirements"===e.path?this.active=0:"/profile"===e.path?this.active=1:"/results"===e.path&&(this.active=2)}},created(){const e=this.$route.path;"/requirements"===e?this.active=0:"/profile"===e?this.active=1:"/results"===e?this.active=2:"/"===e&&(this.active=0)},methods:{handleTouchStart(e){this.currentIcon=e,this.longPressTimer&&clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>{this.onLongPress(e)}),this.longPressDelay)},handleTouchEnd(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.currentIcon=null},handleMouseDown(e){this.currentIcon=e,this.longPressTimer&&clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout((()=>{this.onLongPress(e)}),this.longPressDelay)},handleMouseUp(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null),this.currentIcon=null},onLongPress(e){"requirements"===e?this.$router.push("/requirement/new"):"results"===e&&this.$router.push("/result/new"),(0,x.P0)({message:`正在前往${"requirements"===e?"新建需求":"新建结果"}页面...`,type:"success"})}}};const V=(0,o.A)($,[["render",P],["__scopeId","data-v-65e02d40"]]);var O=V,W={name:"HomePage",components:{HeaderBar:A,NavBar:O}};const M=(0,o.A)(W,[["render",w],["__scopeId","data-v-158472a2"]]);var N=M;const X={class:"page"},B={class:"page-content"};function U(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-empty"),u=(0,i.g2)("van-cell"),d=(0,i.g2)("van-cell-group"),c=(0,i.g2)("van-loading"),m=(0,i.g2)("nav-bar");return(0,i.uX)(),(0,i.CE)("div",X,[(0,i.bF)(l,{title:"需求列表","show-back":!1}),(0,i.Lk)("div",B,[n.loading||0!==n.requirementsList.length?((0,i.uX)(),(0,i.Wv)(d,{key:1,class:"list-container"},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.limitedRequirementsList,(e=>((0,i.uX)(),(0,i.Wv)(u,{key:e.id,title:e.title,"is-link":"",onClick:t=>s.goToDetail(e.id),class:"list-item"},null,8,["title","onClick"])))),128))])),_:1})):((0,i.uX)(),(0,i.Wv)(o,{key:0,description:"暂无需求数据"}))]),n.initialLoading?((0,i.uX)(),(0,i.Wv)(c,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)("加载中...")]))),_:1})):(0,i.Q3)("",!0),(0,i.bF)(m)])}r(2489);var G={name:"Requirements",components:{HeaderBar:A,NavBar:O},data(){return{requirementsList:[],loading:!1,initialLoading:!0}},computed:{limitedRequirementsList(){const e=this.requirementsList.filter((e=>"CREATED"===e.status||"CONFIRMING"===e.status)),t=[...e].sort(((e,t)=>e.updatedAt&&t.updatedAt?new Date(t.updatedAt)-new Date(e.updatedAt):e.createdAt&&t.createdAt?new Date(t.createdAt)-new Date(e.createdAt):0));return t.slice(0,3)}},created(){this.fetchRequirements()},mounted(){window.addEventListener("focus",this.refreshOnFocus)},beforeUnmount(){window.removeEventListener("focus",this.refreshOnFocus)},methods:{async fetchRequirements(){try{this.initialLoading=!0;const e=await v.requirements.getAll();console.log(e),this.requirementsList=JSON.parse(JSON.stringify(e.data)),console.log("获取到的需求数据:",this.requirementsList)}catch(e){console.error("Error fetching requirements:",e),(0,x.xr)("获取需求列表失败")}finally{this.initialLoading=!1}},refreshOnFocus(){"/requirements"===this.$route.path&&this.fetchRequirements()},goToDetail(e){this.$router.push(`/requirement/${e}`)}}};const H=(0,o.A)(G,[["render",U],["__scopeId","data-v-53956121"]]);var j=H;const K={class:"page"},J={class:"page-content"};function z(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-empty"),u=(0,i.g2)("van-cell"),d=(0,i.g2)("van-cell-group"),c=(0,i.g2)("van-loading"),m=(0,i.g2)("nav-bar");return(0,i.uX)(),(0,i.CE)("div",K,[(0,i.bF)(l,{title:"结果列表","show-back":!1}),(0,i.Lk)("div",J,[n.loading||0!==n.resultsList.length?((0,i.uX)(),(0,i.Wv)(d,{key:1,class:"list-container"},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.limitedResultsList,(e=>((0,i.uX)(),(0,i.Wv)(u,{key:e.id,title:e.title,"is-link":"",onClick:t=>s.goToDetail(e.id),class:"list-item"},null,8,["title","onClick"])))),128))])),_:1})):((0,i.uX)(),(0,i.Wv)(o,{key:0,description:"暂无结果数据"}))]),n.initialLoading?((0,i.uX)(),(0,i.Wv)(c,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)("加载中...")]))),_:1})):(0,i.Q3)("",!0),(0,i.bF)(m)])}var Q={name:"Results",components:{HeaderBar:A,NavBar:O},data(){return{resultsList:[],loading:!1,initialLoading:!0}},computed:{limitedResultsList(){return this.resultsList.slice(0,3)}},created(){this.fetchResults()},methods:{async fetchResults(){try{const e=await v.results.getAll();this.resultsList=e.data.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))),this.initialLoading=!1}catch(e){console.error("Error fetching results:",e),(0,x.xr)("获取结果列表失败"),this.initialLoading=!1}},goToDetail(e){this.$router.push(`/result/${e}`)}}};const Z=(0,o.A)(Q,[["render",z],["__scopeId","data-v-7367657c"]]);var Y=Z;const ee={class:"page"},te={class:"page-content"},re={class:"profile-avatar"},ae={class:"action-buttons logout-button"},ie={class:"action-buttons"};function ne(e,t,r,n,s,l){const o=(0,i.g2)("header-bar"),u=(0,i.g2)("van-icon"),d=(0,i.g2)("van-cell"),c=(0,i.g2)("van-cell-group"),m=(0,i.g2)("van-button"),h=(0,i.g2)("van-list"),p=(0,i.g2)("van-tab"),g=(0,i.g2)("van-tag"),v=(0,i.g2)("van-tabs"),q=(0,i.g2)("nav-bar");return(0,i.uX)(),(0,i.CE)("div",ee,[(0,i.bF)(o,{title:"个人信息","show-back":!1}),(0,i.Lk)("div",te,[(0,i.Lk)("div",re,[(0,i.bF)(u,{name:"contact",size:"64"})]),(0,i.bF)(c,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(d,{title:"用户名",value:s.user.name},null,8,["value"]),(0,i.bF)(d,{title:"邮箱",value:s.user.email},null,8,["value"])])),_:1}),(0,i.Lk)("div",ae,[(0,i.bF)(m,{type:"default",block:"",onClick:l.logout},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("退出登录")]))),_:1},8,["onClick"])]),(0,i.bF)(v,{active:s.activeTab,"onUpdate:active":t[2]||(t[2]=e=>s.activeTab=e),sticky:""},{default:(0,i.k6)((()=>[(0,i.bF)(p,{title:"我的需求"},{default:(0,i.k6)((()=>[t[6]||(t[6]=(0,i.Lk)("div",{class:"section-header my-requirements-header"},[(0,i.Lk)("div",{class:"section-title"},"我创建的需求")],-1)),(0,i.bF)(h,{loading:s.myRequirementsLoading,"onUpdate:loading":t[0]||(t[0]=e=>s.myRequirementsLoading=e),finished:s.myRequirementsFinished,"finished-text":"没有更多了",onLoad:l.loadMyRequirements},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.myRequirements,(e=>((0,i.uX)(),(0,i.Wv)(d,{key:e.id,title:e.title,label:l.getApplicantInfo(e),"is-link":"",onClick:t=>l.goToRequirementDetail(e.id)},(0,i.eX)({_:2},["CONFIRMING"===e.status&&e.pendingApproval?{name:"right-icon",fn:(0,i.k6)((()=>[(0,i.Lk)("div",ie,[(0,i.bF)(m,{size:"small",type:"success",onClick:(0,a.D$)((t=>l.approveRequirement(e.id)),["stop"])},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)("同意")]))),_:2},1032,["onClick"]),(0,i.bF)(m,{size:"small",type:"danger",onClick:(0,a.D$)((t=>l.rejectRequirement(e.id)),["stop"])},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("拒绝")]))),_:2},1032,["onClick"])])])),key:"0"}:void 0]),1032,["title","label","onClick"])))),128))])),_:1},8,["loading","finished","onLoad"])])),_:1}),(0,i.bF)(p,{title:"待确认的需求"},{default:(0,i.k6)((()=>[t[7]||(t[7]=(0,i.Lk)("div",{class:"section-header my-applications-header"},[(0,i.Lk)("div",{class:"section-title"},"我申请的需求")],-1)),(0,i.bF)(h,{loading:s.pendingRequirementsLoading,"onUpdate:loading":t[1]||(t[1]=e=>s.pendingRequirementsLoading=e),finished:s.pendingRequirementsFinished,"finished-text":"没有更多了",onLoad:l.loadPendingRequirements},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.pendingRequirements,(e=>((0,i.uX)(),(0,i.Wv)(d,{key:e.id,title:e.title,"is-link":"",onClick:t=>l.goToRequirementDetail(e.id)},{"right-icon":(0,i.k6)((()=>[(0,i.bF)(g,{type:l.getApplicationStatusType(e.applicationStatus)},{default:(0,i.k6)((()=>[(0,i.eW)((0,E.v_)(l.getApplicationStatusText(e.applicationStatus)),1)])),_:2},1032,["type"])])),_:2},1032,["title","onClick"])))),128))])),_:1},8,["loading","finished","onLoad"])])),_:1})])),_:1},8,["active"])]),(0,i.bF)(q)])}var se={name:"ProfilePage",components:{HeaderBar:A,NavBar:O},data(){return{user:{id:"",name:"",email:""},activeTab:0,myRequirements:[],myRequirementsLoading:!1,myRequirementsFinished:!1,pendingRequirements:[],pendingRequirementsLoading:!1,pendingRequirementsFinished:!1}},created(){this.fetchUserData()},methods:{fetchUserData(){this.user=k.state.user||{name:"未知用户",email:"未知邮箱"}},async loadMyRequirements(){try{const e=await v.requirements.getMyRequirementsWithApplications();this.myRequirements=e.data,this.myRequirementsFinished=!0,this.myRequirementsLoading=!1}catch(e){console.error("Error loading my requirements:",e),(0,x.xr)("加载需求失败"),this.myRequirementsLoading=!1}},async loadPendingRequirements(){try{const e=await v.requirements.getMyApplications();this.pendingRequirements=e.data,this.pendingRequirementsFinished=!0,this.pendingRequirementsLoading=!1}catch(e){console.error("Error loading pending requirements:",e),(0,x.xr)("加载申请失败"),this.pendingRequirementsLoading=!1}},async approveRequirement(e){try{await v.requirements.approveApplication(e),(0,x.GF)("已同意申请"),this.loadMyRequirements()}catch(t){console.error("Error approving application:",t),(0,x.xr)("操作失败")}},async rejectRequirement(e){try{await v.requirements.rejectApplication(e),(0,x.GF)("已拒绝申请"),this.loadMyRequirements()}catch(t){console.error("Error rejecting application:",t),(0,x.xr)("操作失败")}},getApplicantInfo(e){return e.applicant&&"CONFIRMING"===e.status?`申请者: ${e.applicant.name}`:`状态: ${this.getStatusText(e.status)}`},getStatusText(e){const t={CREATED:"已创建",CONFIRMING:"确认中",IN_PROGRESS:"进行中",COMPLETED:"已完成",CANCELLED:"已取消"};return t[e]||"未知状态"},getApplicationStatusText(e){const t={PENDING:"等待确认",APPROVED:"已同意",REJECTED:"已拒绝"};return t[e]||"未知状态"},getApplicationStatusType(e){const t={PENDING:"warning",APPROVED:"success",REJECTED:"danger"};return t[e]||"default"},goToRequirementDetail(e){this.$router.push(`/requirement/${e}`)},logout(){k.logout(),this.$router.push("/login")}}};const le=(0,o.A)(se,[["render",ne],["__scopeId","data-v-a2b438d0"]]);var oe=le;const ue={class:"page"},de={class:"page-content"},ce={class:"detail-header"},me={class:"detail-meta"},he={class:"detail-content"},pe={class:"bottom-action-bar"},ge={class:"icon-circle"};function ve(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-tag"),u=(0,i.g2)("van-cell-group"),d=(0,i.g2)("van-cell"),c=(0,i.g2)("van-action-sheet"),m=(0,i.g2)("van-icon");return(0,i.uX)(),(0,i.CE)("div",ue,[(0,i.bF)(l,{title:"需求详情"}),(0,i.Lk)("div",de,[(0,i.Lk)("div",ce,[(0,i.Lk)("h2",null,(0,E.v_)(n.requirement.title),1),(0,i.Lk)("div",me,[(0,i.Lk)("span",null,"发布时间: "+(0,E.v_)(s.formatDate(n.requirement.createdAt)),1),(0,i.bF)(o,{type:s.getStatusType(n.requirement.status),class:"status-tag"},{default:(0,i.k6)((()=>[(0,i.eW)((0,E.v_)(s.getStatusText(n.requirement.status)),1)])),_:1},8,["type"])])]),(0,i.bF)(u,{inset:"",title:"需求描述"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",he,[(0,i.Lk)("p",null,(0,E.v_)(n.requirement.description),1)])])),_:1}),(0,i.bF)(u,{inset:"",title:"操作",style:{"margin-top":"16px"}},{default:(0,i.k6)((()=>[(0,i.bF)(d,{title:"查看相关结果","is-link":"",onClick:s.goToResults},null,8,["onClick"]),(0,i.bF)(d,{title:"更改状态","is-link":"",onClick:t[0]||(t[0]=e=>n.showStatusActionSheet=!0)}),(0,i.bF)(d,{title:"删除需求","is-link":"",onClick:s.confirmDelete},null,8,["onClick"])])),_:1})]),(0,i.bF)(c,{show:n.showStatusActionSheet,"onUpdate:show":t[1]||(t[1]=e=>n.showStatusActionSheet=e),actions:n.statusActions,"cancel-text":"取消",onSelect:s.onSelectStatus},null,8,["show","actions","onSelect"]),(0,i.Lk)("div",pe,[(0,i.Lk)("div",{onClick:t[2]||(t[2]=(...e)=>s.goToAgreement&&s.goToAgreement(...e))},[(0,i.Lk)("div",ge,[(0,i.bF)(m,{name:"friends-o",size:"24"})])])])])}var qe=r(5749),be={name:"RequirementDetailPage",components:{HeaderBar:A},props:{id:{type:[String,Number],required:!0}},data(){return{requirement:{id:"",title:"",description:"",status:"",createdBy:"",createdAt:"",updatedAt:""},loading:!0,showStatusActionSheet:!1,statusActions:[{name:"已创建",value:"CREATED"},{name:"确认中",value:"CONFIRMING"},{name:"进行中",value:"IN_PROGRESS"},{name:"已完成",value:"COMPLETED"},{name:"已取消",value:"CANCELLED"}]}},created(){this.fetchRequirementDetail()},methods:{async fetchRequirementDetail(){this.loading=!0;try{const e=await v.requirements.getById(this.id);this.requirement=e.data}catch(e){console.error("Error fetching requirement detail:",e),(0,x.xr)("获取需求详情失败")}finally{this.loading=!1}},formatDate(e){if(!e)return"未知";const t=new Date(e);return t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},getStatusText(e){const t={CREATED:"已创建",CONFIRMING:"确认中",IN_PROGRESS:"进行中",COMPLETED:"已完成",CANCELLED:"已取消"};return t[e]||"未知状态"},getStatusType(e){const t={CREATED:"primary",CONFIRMING:"warning",IN_PROGRESS:"success",COMPLETED:"success",CANCELLED:"danger"};return t[e]||"default"},async onSelectStatus(e){try{await v.requirements.update(this.id,{status:e.value}),this.requirement.status=e.value,(0,x.GF)("状态更新成功")}catch(t){console.error("Error updating status:",t),(0,x.xr)("状态更新失败")}},confirmDelete(){(0,qe.M5)({title:"确认删除",message:"确定要删除这个需求吗？此操作不可撤销！"}).then((async()=>{try{await v.requirements.delete(this.id),(0,x.GF)("需求已删除"),this.$router.push("/requirements")}catch(e){console.error("Error deleting requirement:",e),(0,x.xr)("删除需求失败")}})).catch((()=>{}))},goToAgreement(){this.$router.push({path:"/agreement",query:{requirementId:this.id,status:this.requirement.status}})},goToResults(){this.$router.push(`/results/requirement/${this.id}`)}}};const fe=(0,o.A)(be,[["render",ve],["__scopeId","data-v-2c7915d4"]]);var ye=fe;const ke={class:"page"},Re={class:"page-content"},we={class:"detail-header"},Ee={class:"detail-meta"},Fe={class:"detail-content"};function Ce(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-loading"),u=(0,i.g2)("van-tag"),d=(0,i.g2)("van-cell-group"),c=(0,i.g2)("van-cell"),m=(0,i.g2)("van-action-sheet");return(0,i.uX)(),(0,i.CE)("div",ke,[(0,i.bF)(l,{title:n.result.title||"结果详情","right-text":"编辑",onRightClick:s.goToEdit},null,8,["title","onRightClick"]),(0,i.Lk)("div",Re,[n.loading?((0,i.uX)(),(0,i.Wv)(o,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)("加载中...")]))),_:1})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",we,[(0,i.Lk)("h2",null,(0,E.v_)(n.result.title),1),(0,i.Lk)("div",Ee,[(0,i.bF)(u,{type:s.getStatusType(n.result.status),class:"status-tag"},{default:(0,i.k6)((()=>[(0,i.eW)((0,E.v_)(s.getStatusText(n.result.status)),1)])),_:1},8,["type"]),(0,i.Lk)("span",null,"创建时间: "+(0,E.v_)(s.formatDate(n.result.createdAt)),1),(0,i.Lk)("span",null,"更新时间: "+(0,E.v_)(s.formatDate(n.result.updatedAt)),1)])]),(0,i.bF)(d,{inset:"",title:"结果描述"},{default:(0,i.k6)((()=>[(0,i.Lk)("div",Fe,[(0,i.Lk)("p",null,(0,E.v_)(n.result.description),1)])])),_:1}),n.result.relatedRequirementId?((0,i.uX)(),(0,i.Wv)(d,{key:0,inset:"",title:"关联需求"},{default:(0,i.k6)((()=>[(0,i.bF)(c,{title:n.relatedRequirementTitle||"查看关联需求","is-link":"",onClick:s.goToRelatedRequirement},null,8,["title","onClick"])])),_:1})):(0,i.Q3)("",!0),(0,i.bF)(d,{inset:"",title:"操作",style:{"margin-top":"16px"}},{default:(0,i.k6)((()=>[(0,i.bF)(c,{title:"更改状态","is-link":"",onClick:t[0]||(t[0]=e=>n.showStatusActionSheet=!0)}),(0,i.bF)(c,{title:"删除结果","is-link":"",onClick:s.confirmDelete},null,8,["onClick"])])),_:1})],64))]),(0,i.bF)(m,{show:n.showStatusActionSheet,"onUpdate:show":t[1]||(t[1]=e=>n.showStatusActionSheet=e),actions:n.statusActions,"cancel-text":"取消",onSelect:s.onSelectStatus},null,8,["show","actions","onSelect"])])}var Le={name:"ResultDetailPage",components:{HeaderBar:A},props:{id:{type:String,required:!0}},data(){return{result:{id:"",title:"",description:"",status:"",relatedRequirementId:null,createdBy:"",createdAt:"",updatedAt:""},relatedRequirementTitle:"",loading:!0,showStatusActionSheet:!1,statusActions:[{name:"草稿",value:"DRAFT"},{name:"已完成",value:"COMPLETED"},{name:"已归档",value:"ARCHIVED"},{name:"已拒绝",value:"REJECTED"}]}},created(){this.fetchResultDetail()},methods:{async fetchResultDetail(){this.loading=!0;try{const e=await v.results.getById(this.id);this.result=e.data,this.result.relatedRequirementId&&this.fetchRelatedRequirement(this.result.relatedRequirementId)}catch(e){console.error("Error fetching result detail:",e),(0,x.xr)("获取结果详情失败")}finally{this.loading=!1}},async fetchRelatedRequirement(e){try{const t=await v.requirements.getById(e);this.relatedRequirementTitle=t.data.title}catch(t){console.error("Error fetching related requirement:",t),this.relatedRequirementTitle="未能获取需求标题"}},formatDate(e){if(!e)return"未知";const t=new Date(e);return t.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},getStatusText(e){const t={DRAFT:"草稿",COMPLETED:"已完成",ARCHIVED:"已归档",REJECTED:"已拒绝"};return t[e]||"未知状态"},getStatusType(e){const t={DRAFT:"primary",COMPLETED:"success",ARCHIVED:"warning",REJECTED:"danger"};return t[e]||"default"},async onSelectStatus(e){try{await v.results.update(this.id,{status:e.value}),this.result.status=e.value,(0,x.GF)("状态更新成功")}catch(t){console.error("Error updating status:",t),(0,x.xr)("状态更新失败")}},confirmDelete(){(0,qe.M5)({title:"确认删除",message:"确定要删除这个结果吗？此操作不可撤销！"}).then((async()=>{try{await v.results.delete(this.id),(0,x.GF)("结果已删除"),this.$router.push("/results")}catch(e){console.error("Error deleting result:",e),(0,x.xr)("删除结果失败")}})).catch((()=>{}))},goToEdit(){this.$router.push(`/result/edit/${this.id}`)},goToRelatedRequirement(){this.result.relatedRequirementId&&this.$router.push(`/requirement/${this.result.relatedRequirementId}`)}}};const Te=(0,o.A)(Le,[["render",Ce],["__scopeId","data-v-1a8d5044"]]);var Ie=Te;const Ae={class:"page"},Se={class:"page-content"},_e={class:"agreement-action"},De={key:0,class:"action-buttons"};function Pe(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-button");return(0,i.uX)(),(0,i.CE)("div",Ae,[(0,i.bF)(l,{title:"协议"}),(0,i.Lk)("div",Se,[t[4]||(t[4]=(0,i.Fv)('<div class="agreement-header" data-v-5de79b75><h2 data-v-5de79b75>服务协议</h2><div class="agreement-version" data-v-5de79b75><span data-v-5de79b75>版本号: v1.0.0</span></div></div><div class="agreement-content" data-v-5de79b75><h3 data-v-5de79b75>1. 协议介绍</h3><p data-v-5de79b75>本协议是您与我们之间关于使用本应用服务所订立的契约。请您仔细阅读本协议，确保理解各条款内容。</p><h3 data-v-5de79b75>2. 服务内容</h3><p data-v-5de79b75>本应用提供需求发布、需求管理和结果展示等服务，具体服务内容以实际提供的为准。我们有权对服务内容进行更新或调整。</p><h3 data-v-5de79b75>3. 用户隐私</h3><p data-v-5de79b75>我们尊重并保护用户隐私。我们会按照隐私政策收集、使用、存储和分享您的个人信息。请您详细阅读我们的隐私政策并理解其内容。</p><h3 data-v-5de79b75>4. 用户行为</h3><p data-v-5de79b75>用户在使用本应用服务时应遵守相关法律法规，不得利用本应用从事违法活动。用户需对自己在本应用上发布的内容负责。</p><h3 data-v-5de79b75>5. 免责声明</h3><p data-v-5de79b75>因网络状况、通讯线路等任何技术原因而导致用户不能正常使用本应用，我们不承担任何法律责任。我们对用户使用本应用的结果不做任何保证。</p><h3 data-v-5de79b75>6. 协议修改</h3><p data-v-5de79b75>我们保留随时修改本协议的权利。协议修改后，将在应用内通知用户。如用户继续使用本应用，则视为接受修改后的协议。</p></div>',2)),(0,i.Lk)("div",_e,[n.requirementId&&"CONFIRMING"===n.requirementStatus?((0,i.uX)(),(0,i.CE)("div",De,[(0,i.bF)(o,{type:"success",onClick:s.approveApplication,loading:n.loading,class:"action-button"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)(" 接受申请 ")]))),_:1},8,["onClick","loading"]),(0,i.bF)(o,{type:"danger",onClick:s.rejectApplication,loading:n.loading,class:"action-button"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.eW)(" 拒绝申请 ")]))),_:1},8,["onClick","loading"])])):n.requirementId&&"CONFIRMING"!==n.requirementStatus?((0,i.uX)(),(0,i.Wv)(o,{key:1,type:"primary",block:"",onClick:s.acceptRequirement,loading:n.loading},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)(" 接受需求 ")]))),_:1},8,["onClick","loading"])):((0,i.uX)(),(0,i.Wv)(o,{key:2,type:"primary",block:"",onClick:s.goBack},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("返回")]))),_:1},8,["onClick"]))])])])}var xe={name:"AgreementPage",components:{HeaderBar:A},data(){return{requirementId:null,requirementStatus:null,loading:!1}},created(){this.$route.query.requirementId&&(this.requirementId=this.$route.query.requirementId,this.requirementStatus=this.$route.query.status)},methods:{goBack(){this.$router.back()},async acceptRequirement(){if(this.requirementId){this.loading=!0;try{await v.requirements.acceptRequirement(this.requirementId),(0,x.GF)("需求已接受，等待确认"),this.$router.push(`/requirement/${this.requirementId}`)}catch(e){console.error("Error accepting requirement:",e),(0,x.xr)("接受需求失败: "+(e.response?.data?.message||"未知错误"))}finally{this.loading=!1}}},async approveApplication(){if(this.requirementId){this.loading=!0;try{await v.requirements.approveApplication(this.requirementId),(0,x.GF)("已同意申请"),this.$router.push(`/requirement/${this.requirementId}`)}catch(e){console.error("Error approving application:",e),(0,x.xr)("同意申请失败: "+(e.response?.data?.message||"未知错误"))}finally{this.loading=!1}}},async rejectApplication(){if(this.requirementId){this.loading=!0;try{await v.requirements.rejectApplication(this.requirementId),(0,x.GF)("已拒绝申请"),this.$router.push(`/requirement/${this.requirementId}`)}catch(e){console.error("Error rejecting application:",e),(0,x.xr)("拒绝申请失败: "+(e.response?.data?.message||"未知错误"))}finally{this.loading=!1}}}}};const $e=(0,o.A)(xe,[["render",Pe],["__scopeId","data-v-5de79b75"]]);var Ve=$e;const Oe={class:"page"},We={class:"page-content"},Me={style:{margin:"16px"}};function Ne(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-field"),u=(0,i.g2)("van-cell-group"),d=(0,i.g2)("van-button"),c=(0,i.g2)("van-form");return(0,i.uX)(),(0,i.CE)("div",Oe,[(0,i.bF)(l,{title:"新建需求"}),(0,i.Lk)("div",We,[(0,i.bF)(c,{onSubmit:s.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(u,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(o,{modelValue:n.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e),name:"title",label:"需求标题",placeholder:"请输入需求标题",rules:[{required:!0,message:"请填写需求标题"}]},null,8,["modelValue"]),(0,i.bF)(o,{modelValue:n.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.description=e),name:"description",label:"需求描述",type:"textarea",rows:"6",placeholder:"请输入需求详细描述",rules:[{required:!0,message:"请填写需求描述"}]},null,8,["modelValue"])])),_:1}),(0,i.Lk)("div",Me,[(0,i.bF)(d,{round:"",block:"",type:"primary","native-type":"submit",loading:n.submitting,disabled:n.submitting},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)(" 提交 ")]))),_:1},8,["loading","disabled"])])])),_:1},8,["onSubmit"])])])}var Xe={name:"NewRequirementPage",components:{HeaderBar:A},data(){return{title:"",description:"",submitting:!1}},methods:{async onSubmit(){this.submitting=!0;try{const e={title:this.title,description:this.description};await v.requirements.create(e),(0,x.GF)("需求创建成功"),setTimeout((()=>{this.$router.push("/requirements")}),1e3)}catch(e){console.error("Error creating requirement:",e),(0,x.xr)("创建需求失败: "+(e.response?.data?.error||"未知错误"))}finally{this.submitting=!1}}}};const Be=(0,o.A)(Xe,[["render",Ne],["__scopeId","data-v-dd4e538e"]]);var Ue=Be;const Ge={class:"page"},He={class:"page-content"},je={style:{margin:"16px"}};function Ke(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-loading"),u=(0,i.g2)("van-field"),d=(0,i.g2)("van-dropdown-item"),c=(0,i.g2)("van-dropdown-menu"),m=(0,i.g2)("van-cell-group"),h=(0,i.g2)("van-button"),p=(0,i.g2)("van-form");return(0,i.uX)(),(0,i.CE)("div",Ge,[(0,i.bF)(l,{title:"编辑需求"}),(0,i.Lk)("div",He,[n.loading?((0,i.uX)(),(0,i.Wv)(o,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("加载中...")]))),_:1})):((0,i.uX)(),(0,i.Wv)(p,{key:1,onSubmit:s.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(m,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(u,{modelValue:n.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e),name:"title",label:"需求标题",placeholder:"请输入需求标题",rules:[{required:!0,message:"请填写需求标题"}]},null,8,["modelValue"]),(0,i.bF)(u,{modelValue:n.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.description=e),name:"description",label:"需求描述",type:"textarea",rows:"6",placeholder:"请输入需求详细描述",rules:[{required:!0,message:"请填写需求描述"}]},null,8,["modelValue"]),(0,i.bF)(u,{name:"status",label:"状态",readonly:""},{input:(0,i.k6)((()=>[(0,i.bF)(c,null,{default:(0,i.k6)((()=>[(0,i.bF)(d,{modelValue:n.status,"onUpdate:modelValue":t[2]||(t[2]=e=>n.status=e),options:n.statusOptions},null,8,["modelValue","options"])])),_:1})])),_:1})])),_:1}),(0,i.Lk)("div",je,[(0,i.bF)(h,{round:"",block:"",type:"primary","native-type":"submit",loading:n.submitting,disabled:n.submitting},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)(" 保存 ")]))),_:1},8,["loading","disabled"])])])),_:1},8,["onSubmit"]))])])}var Je={name:"EditRequirementPage",components:{HeaderBar:A},props:{id:{type:String,required:!0}},data(){return{title:"",description:"",status:"",loading:!0,submitting:!1,statusOptions:[{text:"已创建",value:"CREATED"},{text:"进行中",value:"IN_PROGRESS"},{text:"已完成",value:"COMPLETED"},{text:"已取消",value:"CANCELLED"}]}},created(){this.fetchRequirementDetail()},methods:{async fetchRequirementDetail(){try{const e=await v.requirements.getById(this.id),t=e.data;this.title=t.title,this.description=t.description,this.status=t.status}catch(e){console.error("Error fetching requirement:",e),(0,x.xr)("获取需求详情失败"),this.$router.push(`/requirement/${this.id}`)}finally{this.loading=!1}},async onSubmit(){this.submitting=!0;try{const e={title:this.title,description:this.description,status:this.status};await v.requirements.update(this.id,e),(0,x.GF)("需求更新成功"),setTimeout((()=>{this.$router.push(`/requirement/${this.id}`)}),1e3)}catch(e){console.error("Error updating requirement:",e),(0,x.xr)("更新需求失败: "+(e.response?.data?.error||"未知错误"))}finally{this.submitting=!1}}}};const ze=(0,o.A)(Je,[["render",Ke],["__scopeId","data-v-239685f7"]]);var Qe=ze;const Ze={class:"page"},Ye={class:"page-content"},et={style:{margin:"16px"}};function tt(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-field"),u=(0,i.g2)("van-cell-group"),d=(0,i.g2)("van-button"),c=(0,i.g2)("van-form"),m=(0,i.g2)("van-picker"),h=(0,i.g2)("van-popup"),p=(0,i.g2)("van-loading");return(0,i.uX)(),(0,i.CE)("div",Ze,[(0,i.bF)(l,{title:"新建结果"}),(0,i.Lk)("div",Ye,[(0,i.bF)(c,{onSubmit:s.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(u,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(o,{modelValue:n.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e),name:"title",label:"结果标题",placeholder:"请输入结果标题",rules:[{required:!0,message:"请填写结果标题"}]},null,8,["modelValue"]),(0,i.bF)(o,{modelValue:n.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.description=e),name:"description",label:"结果描述",type:"textarea",rows:"6",placeholder:"请输入结果详细描述",rules:[{required:!0,message:"请填写结果描述"}]},null,8,["modelValue"]),!n.relatedRequirementId&&s.requirementOptions.length>0?((0,i.uX)(),(0,i.Wv)(o,{key:0,readonly:"",name:"relatedRequirement",label:"关联需求",value:n.selectedRequirementTitle,"right-icon":"arrow-down",onClick:t[2]||(t[2]=e=>n.showRequirementPicker=!0)},null,8,["value"])):(0,i.Q3)("",!0),n.relatedRequirementId?((0,i.uX)(),(0,i.Wv)(o,{key:1,readonly:"",name:"relatedRequirementFixed",label:"关联需求",value:n.selectedRequirementTitle},null,8,["value"])):(0,i.Q3)("",!0)])),_:1}),(0,i.Lk)("div",et,[(0,i.bF)(d,{round:"",block:"",type:"primary","native-type":"submit",loading:n.submitting,disabled:n.submitting},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)(" 提交 ")]))),_:1},8,["loading","disabled"])])])),_:1},8,["onSubmit"]),(0,i.bF)(h,{show:n.showRequirementPicker,"onUpdate:show":t[4]||(t[4]=e=>n.showRequirementPicker=e),position:"bottom",round:"",style:{height:"50%"}},{default:(0,i.k6)((()=>[(0,i.bF)(m,{title:"选择关联需求",columns:s.requirementOptions,onConfirm:s.onRequirementConfirm,onCancel:t[3]||(t[3]=e=>n.showRequirementPicker=!1),"show-toolbar":""},null,8,["columns","onConfirm"])])),_:1},8,["show"]),n.loading?((0,i.uX)(),(0,i.Wv)(p,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)("加载中...")]))),_:1})):(0,i.Q3)("",!0)])])}r(1701);var rt={name:"NewResultPage",components:{HeaderBar:A},data(){return{title:"",description:"",relatedRequirementId:this.$route.query.requirementId||"",submitting:!1,loading:!1,showRequirementPicker:!1,requirements:[],selectedRequirementId:"",selectedRequirementTitle:"无关联需求"}},computed:{requirementOptions(){const e=[{text:"无关联需求",value:null}];return e.concat(this.requirements.map((e=>({text:e.title,value:e.id}))))}},created(){this.fetchRequirements(),this.relatedRequirementId&&this.fetchRequirementDetails(this.relatedRequirementId)},methods:{async fetchRequirementDetails(e){this.loading=!0;try{const t=await v.requirements.getById(e);this.selectedRequirementTitle=t.data.title,this.selectedRequirementId=e}catch(t){console.error("Error fetching requirement details:",t),(0,x.xr)("获取需求详情失败")}finally{this.loading=!1}},async fetchRequirements(){this.loading=!0;try{const e=await v.requirements.getAll();this.requirements=e.data}catch(e){console.error("Error fetching requirements:",e),(0,x.xr)("获取需求列表失败")}finally{this.loading=!1}},onRequirementConfirm(e){this.selectedRequirementId=e.value,this.selectedRequirementTitle=e.value?e.text:"无关联需求",this.showRequirementPicker=!1},async onSubmit(){this.submitting=!0;try{const e={title:this.title,description:this.description,relatedRequirementId:this.relatedRequirementId||this.selectedRequirementId||null};await v.results.create(e),(0,x.GF)("结果创建成功"),this.relatedRequirementId?setTimeout((()=>{this.$router.push(`/results/requirement/${this.relatedRequirementId}`)}),1e3):setTimeout((()=>{this.$router.push("/results")}),1e3)}catch(e){console.error("Error creating result:",e),(0,x.xr)("创建结果失败: "+(e.response?.data?.error||"未知错误"))}finally{this.submitting=!1}}}};const at=(0,o.A)(rt,[["render",tt],["__scopeId","data-v-5f09e3eb"]]);var it=at;const nt={class:"page"},st={class:"page-content"},lt={style:{margin:"16px"}};function ot(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-loading"),u=(0,i.g2)("van-field"),d=(0,i.g2)("van-dropdown-item"),c=(0,i.g2)("van-dropdown-menu"),m=(0,i.g2)("van-cell-group"),h=(0,i.g2)("van-button"),p=(0,i.g2)("van-form"),g=(0,i.g2)("van-picker"),v=(0,i.g2)("van-popup");return(0,i.uX)(),(0,i.CE)("div",nt,[(0,i.bF)(l,{title:"编辑结果"}),(0,i.Lk)("div",st,[n.loading?((0,i.uX)(),(0,i.Wv)(o,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[6]||(t[6]=[(0,i.eW)("加载中...")]))),_:1})):((0,i.uX)(),(0,i.Wv)(p,{key:1,onSubmit:s.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(m,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(u,{modelValue:n.title,"onUpdate:modelValue":t[0]||(t[0]=e=>n.title=e),name:"title",label:"结果标题",placeholder:"请输入结果标题",rules:[{required:!0,message:"请填写结果标题"}]},null,8,["modelValue"]),(0,i.bF)(u,{modelValue:n.description,"onUpdate:modelValue":t[1]||(t[1]=e=>n.description=e),name:"description",label:"结果描述",type:"textarea",rows:"6",placeholder:"请输入结果详细描述",rules:[{required:!0,message:"请填写结果描述"}]},null,8,["modelValue"]),(0,i.bF)(u,{name:"status",label:"状态",readonly:""},{input:(0,i.k6)((()=>[(0,i.bF)(c,null,{default:(0,i.k6)((()=>[(0,i.bF)(d,{modelValue:n.status,"onUpdate:modelValue":t[2]||(t[2]=e=>n.status=e),options:n.statusOptions},null,8,["modelValue","options"])])),_:1})])),_:1}),s.requirementOptions.length>0?((0,i.uX)(),(0,i.Wv)(u,{key:0,readonly:"",name:"relatedRequirement",label:"关联需求",value:n.selectedRequirementTitle,"right-icon":"arrow-down",onClick:t[3]||(t[3]=e=>n.showRequirementPicker=!0)},null,8,["value"])):(0,i.Q3)("",!0)])),_:1}),(0,i.Lk)("div",lt,[(0,i.bF)(h,{round:"",block:"",type:"primary","native-type":"submit",loading:n.submitting,disabled:n.submitting},{default:(0,i.k6)((()=>t[7]||(t[7]=[(0,i.eW)(" 保存 ")]))),_:1},8,["loading","disabled"])])])),_:1},8,["onSubmit"])),(0,i.bF)(v,{show:n.showRequirementPicker,"onUpdate:show":t[5]||(t[5]=e=>n.showRequirementPicker=e),position:"bottom",round:"",style:{height:"50%"}},{default:(0,i.k6)((()=>[(0,i.bF)(g,{title:"选择关联需求",columns:s.requirementOptions,onConfirm:s.onRequirementConfirm,onCancel:t[4]||(t[4]=e=>n.showRequirementPicker=!1),"show-toolbar":""},null,8,["columns","onConfirm"])])),_:1},8,["show"])])])}var ut={name:"EditResultPage",components:{HeaderBar:A},props:{id:{type:String,required:!0}},data(){return{title:"",description:"",status:"",relatedRequirementId:null,loading:!0,submitting:!1,showRequirementPicker:!1,requirements:[],selectedRequirementTitle:"无关联需求",statusOptions:[{text:"草稿",value:"DRAFT"},{text:"已完成",value:"COMPLETED"},{text:"已归档",value:"ARCHIVED"},{text:"已拒绝",value:"REJECTED"}]}},computed:{requirementOptions(){const e=[{text:"无关联需求",value:null}];return e.concat(this.requirements.map((e=>({text:e.title,value:e.id}))))}},created(){this.fetchResultDetail(),this.fetchRequirements()},methods:{async fetchResultDetail(){try{const e=await v.results.getById(this.id),t=e.data;this.title=t.title,this.description=t.description,this.status=t.status,this.relatedRequirementId=t.relatedRequirementId,this.relatedRequirementId&&this.fetchRelatedRequirementTitle()}catch(e){console.error("Error fetching result:",e),(0,x.xr)("获取结果详情失败"),this.$router.push(`/result/${this.id}`)}finally{this.loading=!1}},async fetchRelatedRequirementTitle(){if(this.relatedRequirementId)try{const e=await v.requirements.getById(this.relatedRequirementId);this.selectedRequirementTitle=e.data.title}catch(e){console.error("Error fetching related requirement title:",e),this.selectedRequirementTitle="未能获取需求标题"}},async fetchRequirements(){try{const e=await v.requirements.getAll();this.requirements=e.data}catch(e){console.error("Error fetching requirements:",e)}},onRequirementConfirm(e){this.relatedRequirementId=e.value,this.selectedRequirementTitle=e.value?e.text:"无关联需求",this.showRequirementPicker=!1},async onSubmit(){this.submitting=!0;try{const e={title:this.title,description:this.description,status:this.status,relatedRequirementId:this.relatedRequirementId};await v.results.update(this.id,e),(0,x.GF)("结果更新成功"),setTimeout((()=>{this.$router.push(`/result/${this.id}`)}),1e3)}catch(e){console.error("Error updating result:",e),(0,x.xr)("更新结果失败: "+(e.response?.data?.error||"未知错误"))}finally{this.submitting=!1}}}};const dt=(0,o.A)(ut,[["render",ot],["__scopeId","data-v-2e954a90"]]);var ct=dt;const mt={class:"page"},ht={class:"page-content"},pt={class:"requirement-info"};function gt(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-loading"),u=(0,i.g2)("van-empty"),d=(0,i.g2)("van-tag"),c=(0,i.g2)("van-cell"),m=(0,i.g2)("van-cell-group");return(0,i.uX)(),(0,i.CE)("div",mt,[(0,i.bF)(l,{title:"相关结果","right-text":"添加结果",onRightClick:s.goToNewResult},null,8,["onRightClick"]),(0,i.Lk)("div",ht,[n.loading?((0,i.uX)(),(0,i.Wv)(o,{key:0,vertical:"",class:"loading-overlay"},{default:(0,i.k6)((()=>t[0]||(t[0]=[(0,i.eW)("加载中...")]))),_:1})):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",pt,[(0,i.Lk)("h3",null,"需求: "+(0,E.v_)(n.requirementTitle),1)]),0===n.resultsList.length?((0,i.uX)(),(0,i.Wv)(u,{key:0,description:"暂无相关结果数据"})):((0,i.uX)(),(0,i.Wv)(m,{key:1,class:"list-container"},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.resultsList,(e=>((0,i.uX)(),(0,i.Wv)(c,{key:e.id,title:e.title,"is-link":"",onClick:t=>s.goToResultDetail(e.id),class:"list-item"},{"right-icon":(0,i.k6)((()=>[(0,i.bF)(d,{type:s.getStatusType(e.status),class:"status-tag"},{default:(0,i.k6)((()=>[(0,i.eW)((0,E.v_)(s.getStatusText(e.status)),1)])),_:2},1032,["type"])])),_:2},1032,["title","onClick"])))),128))])),_:1}))],64))])])}var vt={name:"ResultsByRequirementPage",components:{HeaderBar:A},props:{requirementId:{type:String,required:!0}},data(){return{resultsList:[],requirementTitle:"",loading:!0}},created(){this.fetchRequirementData(),this.fetchResultsData()},methods:{async fetchRequirementData(){try{const e=await v.requirements.getById(this.requirementId);this.requirementTitle=e.data.title}catch(e){console.error("Error fetching requirement data:",e),this.requirementTitle="未知需求"}},async fetchResultsData(){try{const e=await v.results.getByRequirement(this.requirementId);this.resultsList=e.data}catch(e){console.error("Error fetching results data:",e),(0,x.xr)("获取结果数据失败")}finally{this.loading=!1}},goToResultDetail(e){this.$router.push(`/result/${e}`)},goToNewResult(){this.$router.push(`/result/new?requirementId=${this.requirementId}`)},getStatusText(e){const t={DRAFT:"草稿",COMPLETED:"已完成",ARCHIVED:"已归档",REJECTED:"已拒绝"};return t[e]||"未知状态"},getStatusType(e){const t={DRAFT:"primary",COMPLETED:"success",ARCHIVED:"warning",REJECTED:"danger"};return t[e]||"default"}}};const qt=(0,o.A)(vt,[["render",gt],["__scopeId","data-v-7a95ba4d"]]);var bt=qt;const ft={class:"page"},yt={class:"page-content"},kt={style:{margin:"16px"}},Rt={class:"form-footer"};function wt(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-field"),u=(0,i.g2)("van-cell-group"),d=(0,i.g2)("van-button"),c=(0,i.g2)("van-form"),m=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",ft,[(0,i.bF)(l,{title:"登录","show-back":!1}),(0,i.Lk)("div",yt,[t[5]||(t[5]=(0,i.Lk)("div",{class:"logo-container"},[(0,i.Lk)("h2",{class:"small-seal-font"},"生命树")],-1)),(0,i.bF)(c,{onSubmit:a.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(u,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(o,{modelValue:a.email,"onUpdate:modelValue":t[0]||(t[0]=e=>a.email=e),name:"email",label:"邮箱",placeholder:"请输入邮箱",rules:[{required:!0,message:"请填写邮箱"},{pattern:a.emailPattern,message:"请输入有效的邮箱地址"}]},null,8,["modelValue","rules"]),(0,i.bF)(o,{modelValue:a.password,"onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"])])),_:1}),(0,i.Lk)("div",kt,[(0,i.bF)(d,{round:"",block:"",type:"primary","native-type":"submit",loading:a.loading,disabled:a.loading},{default:(0,i.k6)((()=>t[2]||(t[2]=[(0,i.eW)(" 登录 ")]))),_:1},8,["loading","disabled"])])])),_:1},8,["onSubmit"]),(0,i.Lk)("div",Rt,[(0,i.Lk)("p",null,[t[4]||(t[4]=(0,i.eW)("还没有账号？ ")),(0,i.bF)(m,{to:"/register"},{default:(0,i.k6)((()=>t[3]||(t[3]=[(0,i.eW)("立即注册")]))),_:1})])])])])}var Et={name:"LoginPage",components:{HeaderBar:A},setup(){const e=(0,m.KR)(""),t=(0,m.KR)(""),r=(0,m.KR)(!1),a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,i=async e=>{r.value=!0;try{await k.login({email:e.email,password:e.password}),(0,x.P0)({message:"登录成功",type:"success"});const t=sessionStorage.getItem("redirectPath")||"/";sessionStorage.removeItem("redirectPath"),setTimeout((()=>{window.location.href=t}),1e3)}catch(t){const e=t.response?.data?.error||"登录失败，请检查您的凭据";(0,x.xr)(e)}finally{r.value=!1}};return{email:e,password:t,loading:r,emailPattern:a,onSubmit:i}}};const Ft=(0,o.A)(Et,[["render",wt],["__scopeId","data-v-daa1bf18"]]);var Ct=Ft;const Lt={class:"page"},Tt={class:"page-content"},It={style:{margin:"16px"}},At={class:"form-footer"};function St(e,t,r,a,n,s){const l=(0,i.g2)("header-bar"),o=(0,i.g2)("van-field"),u=(0,i.g2)("van-cell-group"),d=(0,i.g2)("van-button"),c=(0,i.g2)("van-form"),m=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",Lt,[(0,i.bF)(l,{title:"注册"}),(0,i.Lk)("div",Tt,[t[7]||(t[7]=(0,i.Lk)("div",{class:"logo-container"},[(0,i.Lk)("h2",{class:"small-seal-font"},"生命树")],-1)),(0,i.bF)(c,{onSubmit:a.onSubmit},{default:(0,i.k6)((()=>[(0,i.bF)(u,{inset:""},{default:(0,i.k6)((()=>[(0,i.bF)(o,{modelValue:a.email,"onUpdate:modelValue":t[0]||(t[0]=e=>a.email=e),name:"email",label:"邮箱",placeholder:"请输入邮箱",rules:[{required:!0,message:"请填写邮箱"},{pattern:a.emailPattern,message:"请输入有效的邮箱地址"}]},null,8,["modelValue","rules"]),(0,i.bF)(o,{modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=e=>a.name=e),name:"name",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),(0,i.bF)(o,{modelValue:a.password,"onUpdate:modelValue":t[2]||(t[2]=e=>a.password=e),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请填写密码"},{pattern:a.passwordPattern,message:"密码至少6位，包含字母和数字"}]},null,8,["modelValue","rules"]),(0,i.bF)(o,{modelValue:a.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>a.confirmPassword=e),type:"password",name:"confirmPassword",label:"确认密码",placeholder:"请再次输入密码",rules:[{required:!0,message:"请再次输入密码"},{validator:a.validatePasswordConfirmation,message:"两次输入的密码不一致"}]},null,8,["modelValue","rules"])])),_:1}),(0,i.Lk)("div",It,[(0,i.bF)(d,{round:"",block:"",type:"primary","native-type":"submit",loading:a.loading,disabled:a.loading},{default:(0,i.k6)((()=>t[4]||(t[4]=[(0,i.eW)(" 注册 ")]))),_:1},8,["loading","disabled"])])])),_:1},8,["onSubmit"]),(0,i.Lk)("div",At,[(0,i.Lk)("p",null,[t[6]||(t[6]=(0,i.eW)("已有账号？ ")),(0,i.bF)(m,{to:"/login"},{default:(0,i.k6)((()=>t[5]||(t[5]=[(0,i.eW)("立即登录")]))),_:1})])])])])}var _t={name:"RegisterPage",components:{HeaderBar:A},setup(){const e=(0,c.rd)(),t=(0,m.KR)(""),r=(0,m.KR)(""),a=(0,m.KR)(""),i=(0,m.KR)(""),n=(0,m.KR)(!1),s=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,l=/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/,o=e=>e===a.value,u=async t=>{n.value=!0;try{await k.register({email:t.email,name:t.name,password:t.password}),(0,x.P0)({message:"注册成功，请登录",type:"success"}),setTimeout((()=>{e.push("/login")}),1e3)}catch(r){const e=r.response?.data?.error||"注册失败，请重试";(0,x.xr)(e)}finally{n.value=!1}};return{email:t,name:r,password:a,confirmPassword:i,loading:n,emailPattern:s,passwordPattern:l,validatePasswordConfirmation:o,onSubmit:u}}};const Dt=(0,o.A)(_t,[["render",St],["__scopeId","data-v-5c542bcc"]]);var Pt=Dt;const xt=[{path:"/",name:"Home",component:N},{path:"/requirements",name:"Requirements",component:j,meta:{requiresAuth:!0}},{path:"/results",name:"Results",component:Y,meta:{requiresAuth:!0}},{path:"/profile",name:"Profile",component:oe,meta:{requiresAuth:!0}},{path:"/requirement/:id",name:"RequirementDetail",component:ye,props:!0,meta:{requiresAuth:!0}},{path:"/requirement/edit/:id",name:"EditRequirement",component:Qe,props:!0,meta:{requiresAuth:!0}},{path:"/result/:id",name:"ResultDetail",component:Ie,props:!0,meta:{requiresAuth:!0}},{path:"/result/edit/:id",name:"EditResult",component:ct,props:!0,meta:{requiresAuth:!0}},{path:"/results/requirement/:requirementId",name:"ResultsByRequirement",component:bt,props:!0,meta:{requiresAuth:!0}},{path:"/agreement",name:"Agreement",component:Ve},{path:"/requirement/new",name:"NewRequirement",component:Ue,meta:{requiresAuth:!0}},{path:"/result/new",name:"NewResult",component:it,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:Ct,meta:{guest:!0}},{path:"/register",name:"Register",component:Pt,meta:{guest:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}],$t=(0,c.aE)({history:(0,c.Bt)(),routes:xt});$t.beforeEach(((e,t,r)=>{e.matched.some((e=>e.meta.requiresAuth))?k.state.isAuthenticated?r():(sessionStorage.setItem("redirectPath",e.fullPath),r({path:"/login"})):e.matched.some((e=>e.meta.guest))&&k.state.isAuthenticated?r({path:"/"}):r()}));var Vt=$t,Ot=r(4296),Wt=r(8728),Mt=r(7648),Nt=r(828),Xt=r(55),Bt=r(786),Ut=r(7363),Gt=r(9472),Ht=r(3623),jt=r(7515),Kt=r(2352),Jt=r(9056),zt=r(5802),Qt=r(4025),Zt=r(3429),Yt=r(4743),er=r(1824),tr=r(5746),rr=r(5116),ar=r(6767),ir=r(8427),nr=r(5399);r(2241);const sr=(0,a.Ef)(d);sr.use(Vt),sr.use(Ot.$n),sr.use(Wt.HF),sr.use(Mt.gq),sr.use(Nt.fh),sr.use(Xt.Qh),sr.use(Bt.jq),sr.use(Ut.In),sr.use(Gt.lV),sr.use(Ht.D0),sr.use(jt.y8),sr.use(Kt.lG),sr.use(Jt.M9),sr.use(zt.vw),sr.use(Qt.Rh),sr.use(Zt.Ee),sr.use(Yt.j5),sr.use(er.B8),sr.use(tr.Sv),sr.use(rr.zD),sr.use(ar.LC),sr.use(ir.rI),sr.use(nr.tJ),sr.config.globalProperties.$axios=h.A,sr.mount("#app")}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a].call(n.exports,n,n.exports,r),n.exports}r.m=e,function(){var e=[];r.O=function(t,a,i,n){if(!a){var s=1/0;for(d=0;d<e.length;d++){a=e[d][0],i=e[d][1],n=e[d][2];for(var l=!0,o=0;o<a.length;o++)(!1&n||s>=n)&&Object.keys(r.O).every((function(e){return r.O[e](a[o])}))?a.splice(o--,1):(l=!1,n<s&&(s=n));if(l){e.splice(d--,1);var u=i();void 0!==u&&(t=u)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[a,i,n]}}(),function(){r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};r.O.j=function(t){return 0===e[t]};var t=function(t,a){var i,n,s=a[0],l=a[1],o=a[2],u=0;if(s.some((function(t){return 0!==e[t]}))){for(i in l)r.o(l,i)&&(r.m[i]=l[i]);if(o)var d=o(r)}for(t&&t(a);u<s.length;u++)n=s[u],r.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return r.O(d)},a=self["webpackChunkmobile_app"]=self["webpackChunkmobile_app"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=r.O(void 0,[504],(function(){return r(8356)}));a=r.O(a)})();